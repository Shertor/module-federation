## Для полного понимания проделать все пункты от не динамического до динамического режима

### 1. Установить пакет

```bash
npm i -g @angular-architects/module-federation
```

### 2. Перейти в нужную папку и создать корневой проект

```bash
ng new [project-name] --create-application false --minimal
```

### 3. Переходим в проект

```bash
cd [project-name]
```

### 4. Создаем хостовый проект

```bash
ng generate application shell --routing --style scss
```

### 5. Подключаем к хосту библиотеку | Можно делать сразу динамический режим (см. соотв. раздел)

```bash
ng add @angular-architects/module-federation --project shell --port 4200
```

Подтверждаем через Y

### 6. Создаем внутри хоста домашний компонент

```bash
ng generate component home --project shell
```

### 7. Создаем ремоут приложение и настраиваем его см. `Для создания нового модуля`

### 8. Настраиваем роуты в shell (подгрузка lazy-load)

```ts
const routes: Routes = [{ path: "", component: HomeComponent },
{path: "[MFE module name]", loadChildren: () => loadRemoteModule({
        type: "module",
        remoteEntry: `http://localhost:4201/remoteEntry.js`,
        exposedModule: "./Module",
      }).then(m => m.[nameofexport])}];
```

- `[MFE module name]` -- имя подключаемого модуля, из которого экспортируется модуль или компонент
- `[nameofexport]` -- имя экспортируемого модуля или компоненты

Возможна классическая загрузка:
```ts
{path: "clock", loadChildren: () => import('clock/Module').then(m => m.[nameofexport])}
```

### 9. В Корне `src` создаем файл `decl.d.ts` и прописываем в него имя подключаемого модуля

```ts
declare module '[MFE module name]/Module';
```


## Для создания компонента внутри хоста

Классическое использование компонентов внутри хостового приложения.

```bash
ng generate component [name] --project shell
```

## Для создания библиотеки

Общая библиотека может хранить сервисы и интерфейсы общие для всех элементов

<i>В примерах имя библиотеки [name] = shared</i>

```bash
ng generate library [name]
```

Для генерации их внутри библиотеки:

```bash
ng generate interface product --project shared
```

или

```bash
ng generate service products --project shared
```

Подключаем

В папке `shared/src` нужно изменить файл `public-api.ts` в котором прописать экспорты. Например:

```ts
export * from './lib/products.service';
export * from './lib/product';
```

В `shared/src` не нужны все файлы кроме тех, что нужны конкретному сервису или интерфейсу

В `projects/shell/webpack.config.js` нужно импортировать библиотеку добавив ее например вот так
```js
-  [/* mapped paths to share */]);
+  [
+    '@shared'
+  ]);
```

Далее в `tsconfig.json` меняем название библиотеки и путь до нее
```json
-"shared": [
-    "dist/shared/shared"
-]
+
+"@shared": [
+    "projects/shared/src/public-api.ts",
+    "dist/shared"
+]
```

Тогда импорт сервисов и т.п. в компонентах будет выглядить вот так
```ts
import { ... } from "@shared/";
```

## Для создания нового модуля

Создаем приложение (рекомендуется называть их через приставку mfe-)

Обычный:
```bash
ng generate application mfe-[name] --routing --style scss
```

В нем генерируем модуль, который будет экспортироваться

```bash
ng generate module [name] --project mfe-[name] --routing --route [name] --module app
```

Подключаем через (не забываем указать номер порта):

```bash
ng add @angular-architects/module-federation --project [name] --port 4201 
```

Если модуль подгружается не динамически: В `webpack.config.js` настраиваем ту часть, что отвечает за экспорт. 

Экспортируем нужный модуль.

Например:
```js
name: "clock", filename: "remoteEntry.js", exposes: {'./Module': './projects/clock/src/app/integrated-clock/integrated-clock.module.ts',}, 
```


Добавляем модуль в `Routes` с соответствующим портом как в `п.8`.