# Создание проекта Плагинов

<i>В этом разделе рассматривается создание проекта плагинов отдельно от основного проекта и на другой машине. Часть команд и инструкций будет дублировать или дополнять раздел 3.Плагины. Текущий раздел необходимо расценивать как поясняющий отдельные моменты.</i>

* Разработка проводится под версией `node.js v18.12.1`
    * Установка `node.js` проводится с флагом "установить все необходимые компоненты включая Choco"
    * `python` установился с версией 3.11.0
* Версия `npm 8.19.2`
* Angular
```
@angular-devkit/architect    0.1500.4 (cli-only)
@angular-devkit/core         15.0.4 (cli-only)
@angular-devkit/schematics   15.0.4 (cli-only)
@schematics/angular          15.0.4 (cli-only)
```

* Необходим пакет `module-federation` `Version 15.0.2`
```bash
npm i -g @angular-architects/module-federation
```

## Без подключения `@shared` библиотек

Во всех командах предполагается, что на уровень выше создан пустой Angular проект, и уже в нем выполняются команды. 
Пустой проект может быть создан так:

```bash
ng new plugins-example --create-application false --minimal
```

Для создания проекта:

```bash
ng generate application plugins --routing --style scss
```

Далее его необходимо превратить в динамический модуль.

```bash
ng add @angular-architects/module-federation --project plugins --port 4201 --type remote
```

Для создания плагина внутри проекта:

```bash
ng generate component plugin-example --project plugins
```

Созданный плагин необходимо в `AppModule` перенести в `imports`

Сам компонент должен быть standalone
```ts
  standalone: true,
  imports: [CommonModule],
```

Экспорт плагина выполняется следующим образом:

`webpack.config.js`
```js
    './PluginExampleComponent': './projects/plugins/src/app/plugin-example/plugin-example.component.ts',

```

Деплой:
```bash
ng build
```

Для коннекта плагина нужно прописать в манифест его параметры:

```json
  {
    "type": "module",  // Стандартное
    "remoteEntry": "http://localhost/plugins/remoteEntry.js", // Это касается сервера shell приложения
    "exposedModule": "./PluginExampleComponent",

    "unicDisplayName": "PluginExampleComponent", // Уникальное название плагина
    "componentName": "PluginExampleComponent"
  }
```

В случае, если Проект поднят в IIS, то необходимо разместить модуль с этим плагином в корневой папке по аналогии с остальными (см. раздел 4) в папку /plugins/

И обновить манифест как показано выше.

## С подключением `@shared` библиотек

